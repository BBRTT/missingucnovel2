<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>소설 테스트</title>
 <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo&family=Suit:wght@300;400;500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

  <style>



    /* --------------------------
       전체 페이지
    --------------------------- */
    body {

      /* 인트로 전체 화면 */
/* ==========================
   INTRO
========================== */

/* 인트로 전체 화면 */
#intro {
  position: fixed;
  inset: 0;
  z-index: 1000;

  display: flex;
  justify-content: center;
  align-items: center;

  background-image:
    linear-gradient(
      rgba(0, 0, 0, 0.15),
      rgba(0, 0, 0, 0.15)
    ),
    url("정환1.jpg");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;

  transition: opacity 0.8s ease;
  overflow: hidden; /* 스크롤바 방지 */
}

/* 블러 레이어 */
#intro::before {
  content: "";
  position: fixed;
  inset: 0;
  backdrop-filter: blur(2px);
  pointer-events: none;
}

/* 노이즈 레이어 */
#intro::after {
  content: "";
  position: fixed;
  inset: 0;

  background-image: url("노이즈.png");
  background-repeat: repeat;
  opacity: 0.1;


  pointer-events: none;
}

/* 하단 경계선 */
#intro-border {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;

  height: 2px;
  background: linear-gradient(
    to right,
    transparent,
    rgba(255,255,255,0.7),
    transparent
  );

  pointer-events: none;
}

/* 인트로 내용 */
.intro-inner {
  position: relative;
  text-align: center;
}

/* 제목 */
#intro h1 {
  font-family: 'Nanum Myeongjo', serif;
  font-size: 32px;
  margin-bottom: 40px;
  color: #fff;
  text-shadow: 0 2px 6px rgba(0,0,0,0.5);
}

/* 설명 문구 */
#intro p {
  font-size: 14px;
  color: #fff;
  text-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

/* 사라질 때 */
#intro.hide {
  opacity: 0;
  pointer-events: none;
}
#intro.hidden {
  display: none;
}


      font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
      font-size: 15px;               /* 기본 본문 글씨 크기 */
      line-height: 1.1;              /* 줄 간격 */
      letter-spacing: -0.015em;
      padding: 0 10px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #fafafa;
    }

    /* --------------------------
       제목
    --------------------------- */
    h1 {
      font-size: 30px;
      text-align: center;
      margin-bottom: 100px;
      color: #333;
      font-family: 'Nanum Myeongjo', serif;
    
    }
    

    /* --------------------------
       소설 영역
    --------------------------- */
    #story {
      font-family: 'SUIT', sans-serif;
      max-width: 600px;
      text-align: left;
      margin: 0 auto;
      padding: 0 10px;
      line-height: 1.1;
      letter-spacing: -0.015em;
    }
.story-container {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center; /* 화면 중앙 위치 유지 */
  width: 80%;
  margin: 0 auto;
}
currentLine.scrollIntoView({
  behavior: "auto",
  block: "nearest"  // 화면 흔들림 최소화
});
    /* --------------------------
       글 + 이미지 공통 스타일
    --------------------------- */
    .line {
  font-size: 15px !important;
  opacity: 0;
  font-weight: 300;
  transition: opacity 0.4s ease;
  margin-bottom: 20px;
  max-width: 100%;
  height: auto;
  border: none;
  display: block;
  min-height: 2em; /* 줄 간격 일정하게 유지 */
}

.line.show {
  opacity: 1;
}

.line.hide {
  opacity: 0;
}
    
img.line {
  border-radius: 8px;
}
/* 기본 로딩 (big 포함) */
.loading::after {
  content: "";
  display: inline-block;
  animation: dots 1.2s infinite steps(4, end);
  color: #2C3E50;
  font-family: 'Jua', system-ui, sans-serif;
  font-weight: 400;
}

/* 작은 로딩만 더 빠르게 */
.loading.small::after {
  animation-duration: 0.5s;
}
    
.line:has(.loading.big) {
  margin-bottom: 60px;
}


/* 작은 로딩 */
.loading.small {
  font-size: 30px;
  letter-spacing: 7px;
}

/* 큰 로딩 */
.loading.big {
  font-size: clamp(40px, 6vw, 42px);
  letter-spacing: 10px;
  display: inline-block;
  margin: 12px 0;
  font-weight: 600;
}



@keyframes dots {
  0%   { content: ""; }
  25%  { content: "."; }
  50%  { content: ".."; }
  75%  { content: "..."; }
}

    
html, body {
  overflow-x: hidden;
  height:100%;
}
#black-overlay {
  position: fixed;
  inset: 0; /* 상하좌우 0 */
  background: rgba(0,0,0,0.9); /* 검은색 + 투명도 조절 */
  z-index: 9999; /* 모든 콘텐츠 위 */
  opacity: 0; /* 처음에는 안 보이게 */
  pointer-events: none; /* 클릭 방해 안 함 */
  transition: opacity 0.6s ease; /* 천천히 나타나고 사라짐 */
}

/* 나타낼 때 */
#black-overlay.active {
  opacity: 1;
}
html {
  scrollbar-gutter: stable both-edges; /* 항상 스크롤바 공간 확보 */
  overscroll-behavior: none; /* 모바일 바운스 제거 */
}

body {
  overflow-y: scroll; /* 스크롤 항상 생성 */
  margin: 0;          /* 여백으로 인한 흔들림 제거 */
}

  </style>
</head>

<body>
  <!-- 깜빡임용 오버레이 -->
<div id="black-overlay"></div> 
<div id="intro">
  <div class="intro-inner">
<h1> 제발... <h1>
<div id="intro-border"></div>
    <p>화면을 터치하면 이야기가 시작됩니다</p>
    <p>※ 본 글에는 사운드가 포함되어 있습니다 ※</p>
  </div>
</div>

<audio id="bgm1" src="모야.mp3"></audio>
<audio id="bgm2" src="살만찌고.mp3"></audio>
<audio id="bgm3" src="초콜렛군 오렌지양.mp3"></audio>
<audio id="bgm4" src="가슴이 폴짝폴짝.mp3"></audio>
<audio id="bgm5" src="사랑안해.mp3"></audio>
  
<div class="story-container">
  <p class="line disappear bgm3-start">안녕하세요! 잘 지내셨나요?</p>
  <p class="line disappear">예전의 전 유씨노벨 작가가 되는게 꿈이었어요. 하지만 그러기도 전에 그 꿈의 공간이 사라져버렸고 저는 아직도 그 공간을 그리워 하고 다시 꿈꾸고 있어요. 유씨노벨과 같진 않지만 유씨노벨만의 기능을 조금 추가한 이런 공간을 만들어봤습니다.^^.</p>
  <p class="line disappear">그때의 감성이 잘 묻어나는 글이 되길 바라면서 써봅니다. 그럼 재밌게 봐주세요!</p>
  <p class="line disappear">
  <span class="loading small"></span>
</p>

<p class="line disappear">
  <span class="loading big"></span>
</p>

  <p class="line bgm2-start"> 첫문장</p>
  <img class="line bgm4-start" src="KakaoTalk_20251229_220819096.jpg" alt="하루토" />

  <p class="line black-flash"></p>


</div>

<script>
// ------------------------------
// BGM 페이드인/페이드아웃
// ------------------------------
function fadeInSmooth(audio, duration = 1500) {
  audio.pause();
  audio.currentTime = 0;
  audio.volume = 0;
  audio.play();
  const startTime = performance.now();
  function step(now) {
    const t = Math.min((now - startTime) / duration, 1);
    audio.volume = Math.sin(t * Math.PI / 2);
    if (t < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

function fadeOutSmooth(audio, duration = 1500, callback) {
  const startTime = performance.now();
  const initialVolume = audio.volume;
  function step(now) {
    const t = Math.min((now - startTime) / duration, 1);
    audio.volume = initialVolume * Math.cos(t * Math.PI / 2);
    if (t < 1) requestAnimationFrame(step);
    else {
      audio.pause();
      audio.currentTime = 0;
      if (callback) callback();
    }
  }
  requestAnimationFrame(step);
}

// ------------------------------
// 글 + BGM 변수
// ------------------------------
const lines = document.querySelectorAll(".line");
let index = 0;

const bgmMap = {
  "bgm1-start": document.getElementById("bgm1"),
  "bgm2-start": document.getElementById("bgm2"),
  "bgm3-start": document.getElementById("bgm3"),
  "bgm4-start": document.getElementById("bgm4"),
  "bgm5-start": document.getElementById("bgm5")
};

let currentBgm = null;
let introDone = false;

// ------------------------------
// 깜빡임 함수
// ------------------------------
function flashBlack(duration = 800) {
  const overlay = document.getElementById("black-overlay");
  overlay.classList.add("active");
  setTimeout(() => {
    overlay.classList.remove("active");
  }, duration);
}

// ------------------------------
// 클릭 이벤트
// ------------------------------
document.body.addEventListener("click", () => {

  // 아직 인트로면
  if (!introDone) {
    introDone = true;

    const intro = document.getElementById("intro");
    intro.classList.add("hide");

    setTimeout(() => {
      intro.classList.add("hidden");
    }, 900);

    // 첫 줄 보여주기
    const firstLine = document.querySelector(".line");
    firstLine.classList.add("show");
    firstLine.scrollIntoView({ behavior: "smooth", block: "center" });

    return;
  }

  // 인덱스 초과 방지
  if (index >= lines.length) return;

  const currentLine = lines[index];

  // 이전 글 숨기기
  const toDisappear = document.querySelectorAll(".disappear");
  toDisappear.forEach(line => {
    if (line !== currentLine) {
      line.classList.remove("show");
      line.classList.add("hide");
    }
  });

  // 현재 글 등장
  currentLine.classList.add("show");
  currentLine.classList.remove("hide");

  // 깜빡임 적용 (해당 클래스가 있을 때만)
  if (currentLine.classList.contains("black-flash")) {
    flashBlack(200); // 200ms 깜빡임
  }

  // 자동 스크롤
  currentLine.scrollIntoView({
    behavior: window.innerWidth < 768 ? "smooth" : "auto",
    block: "center"
  });

  // BGM 시작/전환
  Object.keys(bgmMap).forEach(key => {
    if (currentLine.classList.contains(key)) {
      if (currentBgm !== bgmMap[key]) {
        if (currentBgm) {
          fadeOutSmooth(currentBgm, 1000, () => {
            currentBgm = bgmMap[key];
            fadeInSmooth(currentBgm, 1500);
          });
        } else {
          currentBgm = bgmMap[key];
          fadeInSmooth(currentBgm, 1500);
        }
      }
    }
  });

  index++;
});
</script>


</body>
</html>
